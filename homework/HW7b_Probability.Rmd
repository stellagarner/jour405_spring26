---
title: "HW7b_Probability"
output: html_document
---

---
title: "HW7b - Probability and the Normal Distribution"
---

In this assignment, you'll build on your z-score skills to answer probability questions using the normal distribution. You'll return to the White House salaries data and use it to answer the kinds of "what are the chances?" questions that come up in journalism all the time. This sets the stage for sampling, which we'll cover next.

### Task 1: Load the tidyverse and the data (1 point)

Load the tidyverse and the White House salaries data from https://raw.githubusercontent.com/dwillis/jour405/refs/heads/main/data/white_house_salaries_2025.csv into a dataframe called `wh_salaries`

```{r}
library(tidyverse)
wh_salaries <- read_csv("https://raw.githubusercontent.com/dwillis/jour405/refs/heads/main/data/white_house_salaries_2025.csv")
```

### Task 2: Filter and summarize (2 points)

You may remember from HW3 that some White House staffers have a salary of $0. Let's filter those out and focus on paid employees, saving the result to a new dataframe called `wh_paid`. You need to calculate the mean, median and standard deviation of the salary column using `wh_paid`:

```{r}
wh_paid <- wh_salaries |>
  filter(SALARY > 0)
```


```{r}
wh_paid <- wh_paid |>
  mutate(
    mean_salary = mean(SALARY),
    median_salary = median(SALARY),
    sd_salary = sd(SALARY))
```

Now create a histogram of the paid salaries with a vertical line for the mean and two more for ±1 standard deviation, similar to what you did in HW6 with Spotify data.

```{r}
wh_paid %>% 
  ggplot() + 
  geom_histogram(aes(x=SALARY), binwidth=10000) +
  geom_vline(aes(xintercept = mean_salary), color = "red", linetype = "dashed", linewidth = 1) +
  geom_vline(aes(xintercept = mean_salary - sd_salary), color = "blue", linetype = "dashed", linewidth = 1) +
  geom_vline(aes(xintercept = mean_salary + sd_salary), color = "blue", linetype = "dashed", linewidth = 1)

```

**Describe the shape of the distribution. Is it roughly normal? Skewed? Where do most salaries cluster?**

This is not at all the standard or symmetrical shape of distribution - it is mainly skewed towards the lower side, considering there are so many higher salaries spread out unevenly. It is interesting to look at the salaries clustered around the 200,000 mark and the roughtly 75,000 mark - those seem to be the most conventional salary brackets for certain positions. 
### Task 3: The Empirical Rule (3 points)

The empirical rule (also called the 68-95-99.7 rule) says that for a normal distribution:
- About 68% of data falls within 1 standard deviation of the mean
- About 95% falls within 2 standard deviations
- About 99.7% falls within 3 standard deviations

Let's test this. We'll calculate the salary ranges for 1, 2, and 3 standard deviations from the mean, then count how many employees actually fall in each range.

```{r}
mean_sal <- mean(wh_paid$SALARY)
sd_sal <- sd(wh_paid$SALARY)
total_n <- nrow(wh_paid)

empirical <- tibble(
  range = c("Within 1 SD", "Within 2 SD", "Within 3 SD"),
  lower = c(mean_sal - sd_sal, mean_sal - 2 * sd_sal, mean_sal - 3 * sd_sal),
  upper = c(mean_sal + sd_sal, mean_sal + 2 * sd_sal, mean_sal + 3 * sd_sal),
  expected_pct = c(68, 95, 99.7),
  actual_count = c(
    sum(wh_paid$SALARY >= (mean_sal - sd_sal) & wh_paid$SALARY <= (mean_sal + sd_sal)),
    sum(wh_paid$SALARY >= (mean_sal - 2 * sd_sal) & wh_paid$SALARY <= (mean_sal + 2 * sd_sal)),
    sum(wh_paid$SALARY >= (mean_sal - 3 * sd_sal) & wh_paid$SALARY <= (mean_sal + 3 * sd_sal))
  ),
  actual_pct = round((actual_count / total_n) * 100, 1)
)

empirical
```

**How closely does the data follow the empirical rule? What does any deviation tell you about the distribution?**

The data is actually not incredibly far from following the empirical rule, but it does seem like a little more of the data falls out of the range in the second set of standard deviations from the mean. This tells us that the data is relatively clustered around the mean, but becomes more scattered as you travel out from there. 

### Task 4: From z-scores to probability with pnorm() (4 points)

Remember the car thefts z-score activity from class? Well, I want to return to that briefly, introduce a new tool called pnorm() and then apply it here. So open that CarTheftZScores notebook and, at the bottom, copy and paste in the contents here: https://gist.githubusercontent.com/dwillis/25102889f576b1707576b85e0be0c353/raw/1ca2be9636497cb5293ff7b1f4e6ed8e27a9e049/car_theft_pnorm.rmd

Re-run all of the blocks in CarTheftZScores notebook, including the code you just pasted in. What's happening there is you are using a function called `pnorm()` to find the probability of a value being less than or equal to a certain z-score. The basic formula to find that probability is:

```
1 - pnorm(z_score)
```

Where `z_score` is one row's z-score. Now apply the same approach to salaries.

Your editor asks: **"What's the probability that a randomly selected White House employee makes more than $150,000?"**

To answer this:
1. Calculate the z-score for $150,000
2. Use `pnorm()` to find the probability. `pnorm()` gives you the area under the normal curve to the LEFT of a z-score — that is, the probability of being BELOW that value.
3. Subtract from 1 to get the probability of being ABOVE $150,000
4. Check your answer against the actual data

```{r}

salary <- 150000
z_score <- (salary - mean_sal) / sd_sal

prob_less <- pnorm(z_score)
prob_more <- 1 - prob_less
prob_more

# Check against actual data
actual_prob <- sum(wh_paid$SALARY > 150000) / total_n
actual_prob
```

**Write a sentence describing this probability in plain English. How does the normal approximation (prob_less) compare to the actual percentage?**

There is a slightly higher than expected chance that any given White House employee makes less than $150,000. This means the salaries skew lower than a standard/symmetrical distribution. 

### Task 5: Probability between two values (3 points)

Now your editor asks: **"What percentage of White House employees make between $80,000 and $120,000?"**

You'll need to calculate z-scores for those two figures, use `pnorm()` for each, and subtract to find the probability between them. Update the REPLACE_ME figures with the appropriate numbers.

```{r}

z_lower <- (sd_sal - mean_sal) / sd_sal
z_upper <- (sd_sal + mean_sal) / sd_sal

prob_between <- pnorm(z_upper) - pnorm(z_lower)
prob_between

# Verify with actual data
actual_between <- sum(wh_paid$SALARY >= 80000 & wh_paid$SALARY <= 120000) / total_n
actual_between

```

**Interpret this result. What does this "middle range" tell us about the White House salary structure?**

This tells us that a good majority of the White House workers fall into this middle range. Based on this, there are very few White house workers which make less than 80,000, but a good amount that do not make more than 120,000.

### Task 6: Expected vs. observed (3 points)

Let's compare what the normal distribution *predicts* to what we actually *see*. This idea — comparing expected to observed — is one you'll use again later in the course.

Create these salary bins and calculate the expected count (from the normal distribution) and the observed count (from the actual data) for each:

```{r}
bins <- tibble(
  category = c("Below $60k", "$60k-$90k", "$90k-$120k", "$120k-$150k", "Above $150k"),
  lower = c(-Inf, 60000, 90000, 120000, 150000),
  upper = c(60000, 90000, 120000, 150000, Inf)
) |>
  mutate(
    expected_pct = pnorm(upper, mean = mean_sal, sd = sd_sal) - pnorm(lower, mean = mean_sal, sd = sd_sal),
    expected_count = round(expected_pct * total_n, 1),
    observed_count = c(
      sum(wh_paid$SALARY < 60000),
      sum(wh_paid$SALARY >= 60000 & wh_paid$SALARY < 90000),
      sum(wh_paid$SALARY >= 90000 & wh_paid$SALARY < 120000),
      sum(wh_paid$SALARY >= 120000 & wh_paid$SALARY < 150000),
      sum(wh_paid$SALARY >= 150000)
    ),
    difference = observed_count - expected_count
  )

bins |> select(category, expected_count, observed_count, difference)
```

**Where does reality differ most from what the normal distribution predicts? What might explain those differences?**

The normal distribution predicts many more workers above 90k, but this chart shows that an unexpected amount of workers fall into the lower 60k-90k range. There are also only two workers who make less than 60k, something which the standard distribution did not account for. This can likely be explained by the fact that White House workers' salaries skew higher than what a standard distribution would account for, and the workers listed below $60k are outliers rather than a regular demographic of workers. 

### Task 7: Story pitch (4 points)

Based on your probability analysis, write a headline and lede for a story about White House salaries. Your lede should incorporate at least one probability or percentage you calculated.

Then write 2-3 sentences describing how you would use probability thinking to advance this story — what could you compare these probabilities to, and what additional analysis would help?

White House workers' salaries higher than standard, 96 percent make over 80k   

At first glance, the graph of White House salaries might look like a majority of workers tend to make less than the overall average. As it turns out, their salaries actually skew high - exorbitantly so, in some cases. About 14 more workers make above $150,000 than a standard distribution of salaries would account for. 

It would probably be helpful to compare these probabilities to a similar company setup with salaries in a similar range and a close mean - maybe a law firm or the corporate arm of a larger company. I would want to see if the company would have a distribution closer to a standard one, or if the way the White House salaries are distributed are simply the norm for higher-level jobs like that. You could also compare the salaries to those of congressional workers - is this typical of government jobs in other branches as well, or is the White House a standout in the amount of workers it pays above 200k? 

### Task 8: Save Your Work and Put it on GitHub

Save this notebook, then commit it to your local repository. Push the changes to your GitHub repository and submit the URL for this file in ELMS.
